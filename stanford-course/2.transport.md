# Transport
The transport layer runs on top of the network layer.
##Â TCP
Used by 95% of Internet apps. 

Stablishes a two-way communication channel: **connection**

It uses a threeway handshake to connect:

A (SYN) -> B *Syncronize*
B (SYN+ACK) -> A *Syncronize + acknoledge*
A (ACK) -> B *Acknoledge*

Syn is what A will use to send packets to B in a way that B can order the packets.
Ack is what B will use to send packets to A.

The stream of bytes is sent by a TCP segment that can be as big as IP datagram supports.

When A and B are over, they have to do a connection teardown. 

A (Fin) -> B
B (Data + Ack) -> A *B might have more data to send before closing the connection*
B (Fin) -> A

####TCP services:
* Stream delivery -> reliable byte delivery service
* Reliable delivery -> using acks to indicate correct delivery of data, sequence numbers to know that there's no missing pices and checksums to be sure that data hasn't been corrupted along the way. If something fails, data will have to be resent. Flow-control is a way to tell the peer you are communicating to whether you can receive more streams or not, so the peer sending data has to slow down.
* In sequence -> Data is sorted in the right order.
* Congestion control

####TCP Segment
* Source port -> So when response comes back we can differenciate among other connections.
* Destination port -> TCP default port is 80
* Sequence # and Acknowledge sequence #
* Checksum

##UDP
Apps that don't need reliable connection.
Simple way to send messages from one host to another without being sure whether the message will or will not be sent.

####UDP Services
* Connectionless
* Unreliable -> no acks, no sequence, no flow control

####UDP datagram
* Source port
* Destination port
* Optional checksum (that includes part of the IP header)

##ICPM

ICMP has a code and also has inside part of the IP header and data, so it can be identified.
####ICPM Services
* Reporting message -> self contained message reporting error.
* Unreliable -> no retries.

####Ping 
Sends a ICMP packet 0,8 (echo) that gets replied with 0, 0 (echo) back if the host is up.

####Traceroute
Sends a UDP packet with TTL 1 so that when it gets to the first host this one replies with an ICPM packet that indicates that TTL has expired. Doing this over and over will result in knowing the whole route the IP packet went through.



